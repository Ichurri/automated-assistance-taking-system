    def export_attendance(self):
        """Export attendance records to a CSV file."""
        if not self.attendance_tree.get_children():
            messagebox.showinfo("Info", "No attendance records to export")
            return
        
        # Ask for file to save
        file_path = filedialog.asksaveasfilename(
            defaultextension=".csv",
            filetypes=[("CSV files", "*.csv"), ("All files", "*.*")],
            title="Export Attendance Records"
        )
        
        if not file_path:
            return  # User cancelled
        
        try:
            import csv
            with open(file_path, 'w', newline='') as csvfile:
                writer = csv.writer(csvfile)
                
                # Write header
                writer.writerow(["Name", "Course", "Date", "Time In", "Time Out", "Duration"])
                
                # Write data from tree
                for item_id in self.attendance_tree.get_children():
                    values = self.attendance_tree.item(item_id, 'values')
                    writer.writerow(values)
                
            messagebox.showinfo("Success", f"Attendance records exported to {file_path}")
            self.add_activity(f"Exported attendance records to CSV file")
            
        except Exception as e:
            messagebox.showerror("Error", f"Failed to export: {str(e)}")
